name: Test Homebrew Installation

on:
  push:
    branches: [dev-homebrew]
  workflow_dispatch:

jobs:
  test-homebrew:
    runs-on: macos-latest

    steps:
      - name: Tap and install aye-chat
        run: |
          brew tap acrotron/ayechat
          brew install --verbose --debug aye-chat 2>&1 || {
            echo "=== Homebrew logs ==="
            find ~/Library/Logs/Homebrew -name "*.log" -exec echo "--- {} ---" \; -exec cat {} \; 2>/dev/null
            exit 1
          }

      - name: Verify installation
        run: |
          which aye
          aye --version

      - name: Test basic functionality
        run: |
          aye --help
